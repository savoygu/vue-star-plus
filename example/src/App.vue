<template>
  <div id="app">
    <demonstration
      tag="h2"
      title="Starç‚¹èµ ç»„ä»¶"
      :show-content="false">
    </demonstration>
    <demonstration
        title="åŸºç¡€ç¤ºä¾‹"
        anchor="demo-code-title"
        :multiple="true"
        :highlight="sourcecode">
      <template slot="description">
        ç®€å•æè¿°ä¸€ä¸‹ç¤ºä¾‹ä»£ç æ ‡é¢˜
      </template>
      <template slot="source">
        <div class="vd-demo__block vd-demo__block-1" style="height: 200px;">
          <span class="vd-demo__demonstration">æŒ‡å®šæ¿€æ´»é¢œè‰²</span>
          <div class="i-star__wrap">
            {{active}}
            <vue-star-plus v-model="active" color="#ff0000" class="i-star__component">
              <span slot="icon" class="i-star__text">{{ active ? 'ğŸ’–' : 'â¤' }}</span>
            </vue-star-plus>
          </div>
        </div>
        <div class="vd-demo__block vd-demo__block-1" style="height: 200px;">
          <span class="vd-demo__demonstration">æŒ‡å®šé»˜è®¤å’Œæ¿€æ´»é¢œè‰²</span>
          <div class="i-star__wrap">
            {{active2}}
            <vue-star-plus v-model="active2" class="i-star__component" @change="active2?++count:--count">
              <span class="i-star__text" slot="icon"
                :style="{
                  color: (active2 ? 'rgb(247, 186, 42)' : '#bfcbd9'),
                  'font-size': '24px'
                }">{{ active2 ? 'ğŸ’˜' : 'â¤'}} {{count}}</span>
            </vue-star-plus>
          </div>
        </div>
      </template>
      <template slot="explanation">
        å¯ä»¥é€šè¿‡ `v-model` çš„å€¼è¿›è¡Œè®¾ç½®é»˜è®¤å’Œæ¿€æ´»é¢œè‰²ã€‚change äº‹ä»¶å¯ä»¥åœ¨æ”¹å˜çŠ¶æ€ä¹‹åè¿›è¡Œ `+1` æˆ– `-1` æ“ä½œ
      </template>
    </demonstration>
    <demonstration
        title="å›¾ç‰‡"
        anchor="demo-code-title"
        :multiple="true"
        :highlight="sourcecode2">
      <template slot="description">
        æˆ‘ä»¬å¯èƒ½ä¼šç”¨åˆ°å›¾ç‰‡ä½œä¸ºç‚¹èµå›¾æ ‡â€”â€”ä¸€ä¸ªæ˜¯æ¿€æ´»çš„ï¼Œä¸€ä¸ªæ˜¯é»˜è®¤çš„ã€‚
      </template>
      <template slot="source">
        <div class="vd-demo__block vd-demo__block-1" style="height: 200px;">
          <span class="vd-demo__demonstration">åˆ‡æ¢ç‚¹èµå›¾ç‰‡</span>
          <div class="i-star__wrap">
            {{active3}}
            <vue-star-plus v-model="active3" class="i-star__component">
              <img class="i-star__picture" slot="icon" :src="require(active3 ? './images/l_rank_star2.png' : './images/l_rank_unstar2.png')">
            </vue-star-plus>
          </div>
        </div>
        <div class="vd-demo__block vd-demo__block-1" style="height: 200px;">
          <span class="vd-demo__demonstration">åˆ‡æ¢ç‚¹èµèƒŒæ™¯</span>
          <div class="i-star__wrap">
            {{active4}}
            <vue-star-plus v-model="active4" class="i-star__component">
              <span class="i-star__bgc" slot="icon"
                :class="{'is-active': active4}"></span>
            </vue-star-plus>
          </div>
        </div>
      </template>
      <template slot="explanation">
        ä¸»è¦æ˜¯é€šè¿‡ active æ¥è¿›è¡Œå›¾ç‰‡å’Œæ ·å¼çš„åˆ‡æ¢ã€‚
      </template>
    </demonstration>
    <demonstration
        title="æ›´å¤šç¤ºä¾‹"
        anchor="demo-code-title"
        :multiple="true"
        :highlight="sourcecode3"
        class="i-star__more">
      <template slot="description">
        ä¼šç”¨åˆ° font-awesome å’Œ animate.css åº“ã€‚
      </template>
      <div class="i-star__operate">
        <span>è°ƒæ•´é—´éš”æ—¶é—´ï¼š{{duration}}ms</span>
        <button @click="adjustmentSpeed(200)">ä¸‹è°ƒ-200ms</button>
        <button @click="adjustmentSpeed(-200)">ä¸Šè°ƒ+200ms</button>
      </div>
      <template slot="source">
        <div class="vd-demo__block vd-demo__block-1" style="height: 200px;" v-for="(item, index) in data" :key="index">
          <span class="vd-demo__demonstration">fa-{{item.font}} å’Œ {{item.animated}}</span>
          <div class="i-star__wrap">
            {{item.model}}
            <vue-star-plus ref="star" v-model="item.model" class="i-star__component" :animate="'animated ' + item.animated">
              <i slot="icon" class="fa fa-2x"
              :class="'fa-'+item.font"
              :style="{ color: item.model ? item.color : '' }"></i>
            </vue-star-plus>
          </div>
        </div>
      </template>
      <template slot="explanation">
      </template>
    </demonstration>
    <demonstration
      :show-content="false">
      <p>ç¤ºä¾‹ä½¿ç”¨è¯¦æƒ…è¯·å‚è€ƒï¼šï¼ˆ<a href="https://github.com/savoygu/vue-demonstration">https://github.com/savoygu/vue-demonstration</a>ï¼‰</p>
    </demonstration>
  </div>
</template>

<script>
  import { sourcecode, sourcecode2, sourcecode3 } from './template'

  export default {
    data () {
      return {
        active: false,
        active2: true,
        active3: false,
        active4: false,
        data: [
          {
            animated: 'tada',
            font: 'bell',
            color: 'rgb(215, 139, 255)',
            model: false
          },
          {
            animated: 'zoomInDown',
            font: 'heart',
            color: 'rgb(240, 86, 84)',
            model: false
          },
          {
            animated: 'rubberBand',
            font: 'bomb',
            color: 'rgb(125, 94, 63)',
            model: false
          },
          {
            animated: 'swing',
            font: 'wrench',
            color: 'rgb(50, 50, 50)',
            model: false
          },
          {
            animated: 'rotateIn',
            font: 'thumbs-up',
            color: 'rgb(152, 138, 222)',
            model: false
          },
          {
            animated: 'wobble',
            font: 'weixin',
            color: 'rgb(254, 163, 134)',
            model: false
          },
          {
            animated: 'rollIn',
            font: 'apple',
            color: 'rgb(253, 145, 145)',
            model: false
          },
          {
            animated: 'bounceInUp',
            font: 'android',
            color: 'rgb(42, 175, 116)',
            model: false
          },
          {
            animated: 'jello',
            font: 'linux',
            color: 'rgb(125, 94, 63)',
            model: false
          }
        ],
        sourcecode,
        sourcecode2,
        sourcecode3,
        current: -1,
        last: -1,
        reverse: false,
        duration: 1000,
        interval: null,
        count: 100
      }
    },

    methods: {
      switchActiveStatus () {
        if (!this.reverse){
          this.last = this.current++
          if (this.current === this.data.length - 1) {
            this.reverse = true
          }
        } else {
          this.last = this.current--
          if (this.current === 0) {
            this.reverse = false
          }
        }
        this.data[this.current].model = !this.data[this.current].model
        if (this.last !== -1) {
          this.data[this.last].model = !this.data[this.last].model
        }
      },

      adjustmentSpeed (speed) {
        clearInterval(this.interval)
        this.duration = this.duration - speed
        if (this.duration < 200) {
          this.duration = 200
        } else if (this.duration > 2000) {
          this.duration = 2000
        }
        console.log(this.duration)
        this.interval = setInterval(_ => {
          this.switchActiveStatus()
        }, this.duration)
      }
    },

    mounted () {
      this.interval = setInterval(_ => {
        this.switchActiveStatus()
      }, this.duration)
    }
  }
</script>

<style lang="less" rel="stylesheet/less">
  #app {
    margin: 60px auto;
    color: #ccc;
  }
  .i-star__wrap {
    position: relative;
  }

  .i-star__component {
    left: 50%;
    margin-left: -50px;
  }

  .i-star__text {
    font-size: 36px;
    user-select: none;
  }

  .i-star__picture {
    display: block;
    width: 36px;
    height: auto;
  }

  .i-star__bgc {
    display: block;
    width: 36px;
    height: 36px;
    background: url("./images/l_rank_unstar2.png") no-repeat;
    background-size: contain;

    &.is-active {
      background-image: url("./images/l_rank_star2.png")
    }
  }

  .i-star__operate {
    padding-bottom: 20px;
    font-size: 16px;
    color: #5e6d82;
    line-height: 1.5em;

    span {
      display: inline-block;
      width: 200px;
    }

    button {
      line-height: 28px;
      color: white;
      background-color: plum;
      border: 1px solid purple;
      border-radius: 3px;
      cursor: pointer;
    }
  }

  .i-star__more {
    .vd-demo__block {
      &.vd-demo__block-1 {
        width: 33.3%;
        &:nth-child(2n) {
          border-right: 1px solid #eff2f6;
        }
        &:nth-child(3n) {
          border-right: none;
        }
      }
    }
  }
</style>
